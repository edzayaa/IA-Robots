---

---

<>
  <script
    is:inline
    defer
    fetchpriority="high"
    src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>
  <script
    is:inline
    defer
    fetchpriority="high"
    src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollTrigger.min.js"
  ></script>
  <script
    is:inline
    defer
    fetchpriority="high"
    src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/ScrollSmoother.min.js"
  ></script>

  <script
    is:inline
    defer
    fetchpriority="high"
    src="https://cdn.jsdelivr.net/npm/gsap@3.14.1/dist/SplitText.min.js"
  ></script>

  <script>
    import { navigate } from "astro:transitions/client";
    import { fonts } from "../scripts/utils/fonts";
    import { footer } from "../scripts/footer";
    import { goHome } from "../scripts/goHome";
    import { nav } from "../scripts/nav";
    import { menu } from "../scripts/menu";
    import { readPathname } from "../scripts/utils/pathname";
    import { pages } from "../scripts/pages";
    import { resolution, mm, breakPoints } from "../scripts/utils/resolution";
    import { intro } from "../scripts/preloader";
    import { active_link } from "@/scripts/active_link";
    import { intro_animations } from "@/scripts/intro_animations";
    import { table_animation } from "@/scripts/table_animation";
    import { cards_animation } from "@/scripts/cards_animation";
    import { book_animation } from "@/scripts/book_animation";

    fonts();

    gsap.config({
      nullTargetWarn: import.meta.env.DEV,
    });

    let scrollbar: any;
    let pathname: string = readPathname();
    const logo = document.querySelector("#preloader > .logo");
    logo?.classList.remove("intro");

    document.addEventListener("DOMContentLoaded", () => {
      if (pathname === "/") {
        const introTl = intro() as any;
        introTl.tweenTo(introTl.totalDuration());
      }
    });

    document.addEventListener("astro:page-load", () => {
      pathname = readPathname();

      const logo = document.querySelector("#preloader > .logo");
      logo?.classList.remove("intro");

      mm.add(breakPoints, (context: any) => {
        const { isPortraitRes, isDesktopRes } = context.conditions;
        resolution.isPortrait = isPortraitRes;

        if (isDesktopRes) {
          scrollbar = ScrollSmoother.create({
            smooth: 1.5,
            speed: 0.5,
            smoothTouch: 0,
          });
          ScrollTrigger.normalizeScroll({
            allowNestedScroll: true,
          });
        }

        return () => {
          ScrollTrigger.killAll();
        };
      });

      switch (pathname) {
        case pages.home.path:
          import("../scripts/home").then(({ home }) => home());
          break;

        case pages.quadruped.path:
          import("../scripts/quadruped").then(({ quadruped }) => quadruped());
          break;

        case pages.go2_w.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.b2_w.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.go2.path:
          import("../scripts/sequence_frames").then(({ sequence_frames }) =>
            sequence_frames(),
          );
          import("../scripts/simple_section_animation").then(
            ({ simple_section_animation }) => simple_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.b2.path:
          import("../scripts/sequence_frames").then(({ sequence_frames }) =>
            sequence_frames(),
          );
          import("../scripts/simple_section_animation").then(
            ({ simple_section_animation }) => simple_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.a2.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.manipulators.path:
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.perception.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages["h1-h2"].path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.h2.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.r1.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.g1.path:
          import("../scripts/sequence_frames").then(({ sequence_frames }) =>
            sequence_frames(),
          );
          import("../scripts/scroll_text_contained_animation").then(
            ({ scroll_text_contained_animation }) =>
              scroll_text_contained_animation(),
          );

          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.holographic_cabinet.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.oled_mobile_robot.path:
          import("../scripts/new_section_animation").then(
            ({ new_section_animation }) => new_section_animation(),
          );
          import("../scripts/video_media").then(({ video_media }) =>
            video_media(),
          );
          break;

        case pages.industry.path:
          import("../scripts/industries").then(({ industries }) =>
            industries(),
          );
          break;

        case pages.product.path:
          import("../scripts/product_page").then(({ product_page }) =>
            product_page(),
          );
          break;

        case pages.careers.path:
          import("../scripts/careers").then(({ careers }) => careers());
          break;

        case pages.privacy_policy.path:
          import("../scripts/legal").then(({ legal }) => legal());
          break;

        case pages.returns_refunds.path:
          import("../scripts/legal").then(({ legal }) => legal());
          break;

        case pages.terms_conditions.path:
          import("../scripts/legal").then(({ legal }) => legal());
          break;

        case pages.cookie_policy.path:
          import("../scripts/legal").then(({ legal }) => legal());
          break;

        case pages.shipping_delivery.path:
          import("../scripts/legal").then(({ legal }) => legal());
          break;

        default:
          break;
      }
      console.log("Loading: ", pathname);

      goHome();
      nav();
      menu();
      footer();
      active_link();
      intro_animations();
      table_animation();
      cards_animation();
      book_animation();
    });

    document.addEventListener("astro:before-swap", () => {
      ScrollTrigger.killAll();
      scrollbar.kill();
    });
  </script>
</>
